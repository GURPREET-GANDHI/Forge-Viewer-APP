{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./extensions/Gamepad/GamepadModule.js","webpack://Autodesk.Extensions.[name]/./extensions/FirstPerson/FirstPersonTool.js","webpack://Autodesk.Extensions.[name]/./extensions/FirstPerson/FirstPerson.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GamepadModule","viewerapi","_gamepad","_hudMessageStartShowTime","_hudMessageShowTime","_viewerState","_savepoints","_nextsavepoint","_lockInPlane","_actualMoveSpeed","_altitudeLockCoord","_currentTool","avp","Autodesk","Viewing","Private","_navapi","navigation","_container","container","_camera","getCamera","_modelScaleFactor","_THRESHOLD","_speed_scalar","_btnPressMap","_clock","THREE","Clock","VIEWER_STATE_FILTER","seedURN","objectSet","viewport","renderOptions","environment","ambientOcclusion","toneMap","exposure","appearance","_BUTTONS","SOUTH_BTN","EAST_BTN","WEST_BTN","NORTH_BTN","LEFT_SHOULDER","RIGHT_SHOULDER","LEFT_TRIGGER","RIGHT_TRIGGER","SOUTH_DPAD","EAST_DPAD","WEST_DPAD","NORTH_DPAD","LEFT_STICK_BUTTON","RIGHT_STICK_BUTTON","_STICKS","LEFT_STICK_X","LEFT_STICK_Y","RIGHT_STICK_X","RIGHT_STICK_Y","_BLANK_FUNC","_BUTTON_MAPPING","k","this","activate","toolName","boundsSize","model","getBoundingBox","size","Math","max","min","x","y","z","navigator","getGamepads","ViewerState","setMapping","deactivate","update","delta","camera","getDelta","Date","getTime","hideHUD","isPerspective","toPerspective","btn","buttons","pressed","abs","axes","inputDetected","dirty","position","direction","target","clone","sub","distance","length","multiplyScalar","right","cross","up","normalize","forwardMove","add","strafeMove","lookUpDown","Quaternion","ndir","tempCam","tempDir","setFromAxisAngle","applyQuaternion","vertical","worldup","vertAngle","angleTo","vertLimit","degToRad","PI","lookLeftRight","handleGamepadButton","handleGamepadFaceButtons","copy","HudMessage","dismiss","showDPadHud","message","messageSpecs","showDelay","closeCB","buttonCB","checkboxCB","displayMessage","showHUD","buttonIdx","mapping","selectObject","goHome","toggleNavMode","hideObject","decAltitude","incAltitude","explode","fineSpeedAdjust","deselectAll","unhideAll","createSavePoint","showPropertyPanel","previousSavePoint","nextSavePoint","triggerZoom","setRequestHomeView","showAll","impl","selector","clearSelection","translateY","analog_value","fov","state","getState","push","logger","log","restoreState","res","hitTestViewport","Vector3","updateMatrixWorld","toggleSelection","dbId","getHiddenNodes","show","hide","getPropertyPanel","setVisible","isVisible","FirstPersonTool","_isMac","userAgent","search","_names","setGlobalManager","globalManager","_gamepadModule","_modifierState","SHIFT","ALT","CONTROL","_keys","KeyCode","_isActive","_mouseDraggingLookMode","_isDragging","_touchType","_movementSpeed","_wheelDelta","_lastX","_lastY","_deltaYaw","_deltaPitch","_moveForward","_moveBackward","_moveLeft","_moveRight","_moveUp","_moveDown","_bDontShowAgain_HelpHUD","webkitGetGamepads","webkitGamepads","_trackToolUsed","isActive","getNames","getName","start","setVerticalFov","getUnitScale","canvas","focus","getFirstPersonToolPopup","showHelpHUD","addCrosshair","pauseHighlight","stop","removeCrosshair","getCursor","adjustSpeed","handleGesture","event","pointers","pageX","pageY","type","handleButtonDown","handleMouseMove","handleButtonUp","handleSingleClick","button","_window","getWindow","modifierState","ctrlKey","metaKey","shiftKey","altKey","getEventModifierState","innerWidth","innerHeight","dx","dy","handleKeyDown","keyCode","handled","ESCAPE","TAB","SPACE","EQUALS","DASH","ZERO","UP","w","LEFT","a","DOWN","RIGHT","q","e","g","F1","handleKeyUp","firstPersonToolUsed","showDraggingLookModeHUD","handleWheelInput","getReverseZoomDirection","handleDoubleClick","handleSingleTap","handleDoubleTap","handleBlur","isActionEnabled","console","localCam","actualMoveSpeed","actualVerticalMoveSpeed","actualWheelMoveSpeed","translateZ","translateX","newPosition","posChanged","distanceToSquared","newTarget","directionFwd","directionRight","pitchQ","dirFwdTmp","yawQ","targetChanged","setView","orientCameraUp","track","category","enabled","themessage","setFirstPersonToolPopup","stringToDOM","crosshair","canvasWrap","appendChild","parentNode","removeChild","FirstPersonExtension","viewer","options","Extension","GlobalManagerMixin","constructor","proto","load","self","avu","UI","tool","toolController","registerTool","createUI","onToolChanged","indexOf","firstPersonToolButton","active","Button","State","ACTIVE","INACTIVE","setState","addEventListener","TOOL_CHANGE_EVENT","getToolbar","navTools","getControl","TOOLBAR","NAVTOOLSID","setToolTip","onClick","activeStatus","setIcon","cameraSubmenuTool","addControl","index","getId","unload","removeEventListener","undefined","getHotkeyManager","popHotkeys","HOTKEYS_ID","removeFromParent","getActiveNavigationTool","setActiveNavigationTool","deregisterTool","theExtensionManager","registerExtension"],"mappings":"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","file":"FirstPerson/FirstPerson.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 559);\n","/***\n* GamepadModule is a tool (not an extension) that reacts to input from\n* a gamepad controller plugged into the hosting machine.\n *\n* @param viewerapi\n* @constructor\n*/\nexport function GamepadModule( viewerapi ) {\n\n    var avp = Autodesk.Viewing.Private;\n\n    var _navapi = viewerapi.navigation;\n    var _container = viewerapi.container;\n    var _camera = _navapi.getCamera();\n\n    var _modelScaleFactor = 1.0;\n\n    var _explodeSpeed = 0;\n\n    var _THRESHOLD = 0.1;\n    var _SPEED_ADJUST = 5.5,\n        _INITIAL_SPEED_SCALAR = 6,\n        _speed_scalar = _INITIAL_SPEED_SCALAR;\n\n\n    var _btnPressMap = {};\n    var _gamepad;\n    var _hudMessageStartShowTime;\n    var _hudMessageShowTime;\n    var _viewerState;\n    var _savepoints;\n    var _nextsavepoint;\n\n    //Nav mode toggle\n    var _lockInPlane;\n\n    var _clock = new THREE.Clock(true);\n\n    var VIEWER_STATE_FILTER = {\n        seedURN: false,\n        objectSet: true,\n        viewport: true,\n        renderOptions: {\n            environment: false,\n            ambientOcclusion: false,\n            toneMap: {\n                exposure: false\n            },\n            appearance: false\n        }\n    };\n    var _actualMoveSpeed;\n    var _movementSpeed = 2.0;\n    var _INITIAL_FOV = 75;\n    var _ZOOM_SCALAR = -45;//smaller => closer zoom\n    var _altitudeLockCoord;\n    var _currentTool;\n\n    /*Face Buttons*/\n    var _BUTTONS = {\n        SOUTH_BTN : 0,\n        EAST_BTN : 1,\n        WEST_BTN : 2,\n        NORTH_BTN : 3,\n\n        /*Shoulder and trigger buttons*/\n        LEFT_SHOULDER : 4,\n        RIGHT_SHOULDER : 5,\n        LEFT_TRIGGER : 6,//ANALOG\n        RIGHT_TRIGGER : 7,//ANALOG\n\n        /*directional pad (DPad)*/\n        SOUTH_DPAD : 13,\n        EAST_DPAD : 15,\n        WEST_DPAD : 14,\n        NORTH_DPAD : 12,\n\n        /*Joystick buttons (press joystick in)*/\n        LEFT_STICK_BUTTON: 10,\n        RIGHT_STICK_BUTTON: 11\n\n    };\n\n    var _STICKS = {\n        //Axis//\n        /*Left and right joysticks*/\n        LEFT_STICK_X : 0,//ANALOG\n        LEFT_STICK_Y : 1,//ANALOG\n        RIGHT_STICK_X : 2,//ANALOG\n        RIGHT_STICK_Y : 3//ANALOG\n    };\n\n    var _BLANK_FUNC = function() {};\n    var _BUTTON_MAPPING = {};\n    for (var k in _BUTTONS) {\n        if(_BUTTONS.hasOwnProperty(k))\n            _BUTTON_MAPPING[_BUTTONS[k]] = _BLANK_FUNC;\n    }\n\n    var init = function() {\n\n    };\n\n    this.activate = function (toolName) {\n        // Calculate a movement scale factor based on the model bounds.\n        var boundsSize = viewerapi.model.getBoundingBox().size();\n        _modelScaleFactor = Math.max(Math.min(Math.min(boundsSize.x, boundsSize.y), boundsSize.z) / 10.0, 0.0001);\n        _gamepad = navigator.getGamepads()[0];\n        _viewerState = new Autodesk.Viewing.Private.ViewerState(viewerapi);\n        _savepoints = [];\n        _nextsavepoint = 0;\n        _currentTool = toolName;\n        setMapping(toolName);\n    };\n\n    this.deactivate = function(){\n        //console.log(\"DEACTIVATE\");\n        _currentTool = null;\n        _viewerState = null;\n    };\n\n    this.update = function (delta, camera) {\n\n        if(camera)\n            _camera = camera;\n        delta = _clock.getDelta();\n\n        //poll for gamepad connection\n        _gamepad = navigator.getGamepads()[0];\n\n        if (_hudMessageStartShowTime > -1) {\n            var curTime = new Date().getTime();\n            if (curTime - _hudMessageStartShowTime > _hudMessageShowTime) { // seconds\n                hideHUD();\n            }\n        }\n\n        if(_gamepad) {\n            _actualMoveSpeed = delta * _movementSpeed * _modelScaleFactor * _speed_scalar;// (_gamepad.buttons[_BUTTONS.RIGHT_TRIGGER].value > _THRESHOLD ? _SPEED_ADJUST * _gamepad.buttons[_BUTTONS.RIGHT_TRIGGER].value + _MAX_SPEED_SCALAR : _MAX_SPEED_SCALAR);\n            // From the Collaboration extension:\n            //the \"go home\" call may change the camera back to ortho... and we can't do ortho while walking...\n            //HACK: Really, the home view should be set once when launch the extension, then set it back.\n            if (!_camera.isPerspective) {\n                //console.log(\"Lost perspective mode: resetting view.\");\n                _navapi.toPerspective();\n            }\n            if (_gamepad) {//TODO test for connection (change of state?)\n                if (inputDetected()) {//need to update camera scene\n                   // console.log(\"needs update\");\n                    _camera.dirty = true;\n                    if (_lockInPlane) {\n                        _altitudeLockCoord = _camera.position.z;\n                    }\n\n                    var direction = _camera.target.clone().sub(_camera.position);\n                    var distance = direction.length();\n                    direction.multiplyScalar(1.0 / distance);\n                    var right = direction.clone().cross(_camera.up).normalize();\n                    if (Math.abs(_gamepad.axes[_STICKS.LEFT_STICK_Y]) > _THRESHOLD) {\n                        var forwardMove = direction.clone().multiplyScalar(-_gamepad.axes[_STICKS.LEFT_STICK_Y] * _actualMoveSpeed);\n                        _camera.position.add(forwardMove);\n                        _camera.target.add(forwardMove);\n                    }\n\n                    if (Math.abs(_gamepad.axes[_STICKS.LEFT_STICK_X]) > _THRESHOLD) {\n                        var strafeMove = right.clone().multiplyScalar(_gamepad.axes[_STICKS.LEFT_STICK_X] * _actualMoveSpeed);\n                        _camera.position.add(strafeMove);\n                        _camera.target.add(strafeMove);\n                    }\n\n                    var lookUpDown = new THREE.Quaternion();\n                    var ndir = direction;\n                    if (Math.abs(_gamepad.axes[_STICKS.RIGHT_STICK_Y]) > _THRESHOLD) {\n\n                        var tempCam = _camera.clone();//modify this camera to see if it will be in viable range\n                        var tempDir = direction.clone();\n\n                        lookUpDown.setFromAxisAngle(right, -_gamepad.axes[_STICKS.RIGHT_STICK_Y] * _actualMoveSpeed / 2);//lookscale\n\n                        tempDir.applyQuaternion(lookUpDown);\n                        tempCam.up.applyQuaternion(lookUpDown);\n                        var vertical = tempCam.worldup.clone();\n                        var vertAngle = tempDir.angleTo(vertical);\n                        var vertLimit = THREE.Math.degToRad(5);\n\n                        // If new angle is within limits then update values; otherwise ignore\n                        if ( vertAngle >= vertLimit && vertAngle <= (Math.PI - vertLimit) ) {\n                            ndir = direction.clone().applyQuaternion(lookUpDown);\n                            _camera.up.applyQuaternion(lookUpDown);\n                        }\n                    }\n\n                    var lookLeftRight = new THREE.Quaternion();\n                    if (Math.abs(_gamepad.axes[_STICKS.RIGHT_STICK_X]) > _THRESHOLD) {\n                        lookLeftRight.setFromAxisAngle(_camera.worldup, -_gamepad.axes[_STICKS.RIGHT_STICK_X] * _actualMoveSpeed / 2);//lookscale\n                        ndir.applyQuaternion(lookLeftRight);\n                        _camera.up.applyQuaternion(lookLeftRight);\n                    }\n\n                    /*HANDLE ALL BUTTON INPUTS*/\n                    handleGamepadFaceButtons();\n                    /**************************/\n\n                    if (_lockInPlane)\n                        _camera.position.z = _altitudeLockCoord;\n\n                    ndir.multiplyScalar(distance);\n                    _camera.target.copy(_camera.position).add(ndir);\n                }\n            }\n        }\n        return _camera;\n    };\n\n\n    // Show a HUD for a specific amount of time (showDelay > 0) or until closed.\n    var showHUD = function(messageSpecs, showDelay, closeCB, buttonCB, checkboxCB)\n    {\n        Autodesk.Viewing.Private.HudMessage.displayMessage(_container, messageSpecs, closeCB, buttonCB, checkboxCB);\n\n        if (showDelay > 0) {\n            _hudMessageStartShowTime = new Date().getTime();\n            _hudMessageShowTime = showDelay;\n        }\n        else {\n            _hudMessageStartShowTime = -1;\n            _hudMessageShowTime = 0;\n        }\n    };\n\n    var hideHUD = function()\n    {\n        Autodesk.Viewing.Private.HudMessage.dismiss();  // in case it's still visible\n        _hudMessageStartShowTime = -1;\n    };\n\n    var showDPadHud = function(direction)\n    {\n        hideHUD();\n        var message;\n        switch(direction) {\n            case \"up\":\n                message = _lockInPlane ? \"Vertical Lock Mode\" : \"Fly mode\"; break;\n            case \"left\":\n                break;\n            case \"right\":\n                break;\n            case \"down\":\n                break;\n        }\n\n        var messageSpecs = {\n            \"msgTitleKey\"   : \"View Orientation Drag Mode Toggled\",\n            \"messageKey\"    : \"View Orientation Drag Mode Toggled\",\n            \"messageDefaultValue\"  : message\n\n        };\n        showHUD(messageSpecs, 2000);//show hud for 2secs\n\n    };\n\n    //checks for any button doing anything important\n    function inputDetected(){\n        //check to see if we pressed a button last frame\n        //loop through mapping to only check buttons we care about\n        for (var btn in _BUTTON_MAPPING) {\n            if (_BUTTON_MAPPING.hasOwnProperty(btn)) {\n                if(_gamepad.buttons[btn].pressed){\n                    if(_gamepad.buttons[btn].value != 0.5) {\n                        _btnPressMap[btn] = true;//its pressed!\n                        return true;\n                    }\n                }\n            }\n        }\n        for (var btn in _btnPressMap) {\n            if (_btnPressMap.hasOwnProperty(btn)) {\n                if(_btnPressMap[btn]){\n                    //_btnPressMap[btn] = false;//\n                    return true;\n                }\n            }\n        }\n        //now check movement\n        return !(Math.abs(_gamepad.axes[_STICKS.LEFT_STICK_X]) < _THRESHOLD &&\n                Math.abs(_gamepad.axes[_STICKS.LEFT_STICK_Y]) < _THRESHOLD &&\n                Math.abs(_gamepad.axes[_STICKS.RIGHT_STICK_X]) < _THRESHOLD &&\n                Math.abs(_gamepad.axes[_STICKS.RIGHT_STICK_Y]) < _THRESHOLD);\n\n    }\n\n    /*\n    will check face buttons (including Directional Pad) for input\n     */\n    function handleGamepadFaceButtons(){\n        for(var btn in _BUTTONS){\n            if(_BUTTONS.hasOwnProperty(btn)){\n                handleGamepadButton(_BUTTONS[btn]);\n            }\n        }\n    }\n\n    function handleGamepadButton(buttonIdx) {\n        //buttons in first IF are testing for being held (good for analog inputs and held down buttons)\n        //ELSE IF will activate upon RELEASE of a button\n        if (_gamepad.buttons[buttonIdx].value > _THRESHOLD) {\n            _btnPressMap[buttonIdx] = true;//set was_pressed\n            switch (buttonIdx) {\n                case _BUTTONS.LEFT_SHOULDER:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.RIGHT_SHOULDER:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.LEFT_TRIGGER:\n                    _BUTTON_MAPPING[buttonIdx](_gamepad.buttons[_BUTTONS.LEFT_TRIGGER].value); break;\n                case _BUTTONS.RIGHT_TRIGGER:\n                    _BUTTON_MAPPING[buttonIdx](_gamepad.buttons[_BUTTONS.RIGHT_TRIGGER].value); break;\n            }\n        }\n        //ON RELEASE\n        else if (_btnPressMap[buttonIdx]) {\n            _btnPressMap[buttonIdx] = false;\n            switch (buttonIdx) {\n                case _BUTTONS.SOUTH_BTN:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.EAST_BTN:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.WEST_BTN:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.NORTH_BTN:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.NORTH_DPAD:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.SOUTH_DPAD:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.WEST_DPAD:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.EAST_DPAD:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.RIGHT_STICK_BUTTON:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.LEFT_STICK_BUTTON:\n                    _BUTTON_MAPPING[buttonIdx](); break;\n                case _BUTTONS.LEFT_TRIGGER:\n                    _BUTTON_MAPPING[buttonIdx](_gamepad.buttons[_BUTTONS.LEFT_TRIGGER].value); break;\n                case _BUTTONS.RIGHT_TRIGGER:\n                    _BUTTON_MAPPING[buttonIdx](_gamepad.buttons[_BUTTONS.RIGHT_TRIGGER].value); break;\n            }\n        }\n    }\n\n    var setMapping = function(mapping){\n        switch(mapping) {\n            case \"headtracker\":\n                _BUTTON_MAPPING[_BUTTONS.SOUTH_BTN] = selectObject;\n                _BUTTON_MAPPING[_BUTTONS.SOUTH_DPAD] = goHome;\n                _BUTTON_MAPPING[_BUTTONS.NORTH_DPAD] = toggleNavMode;\n                _BUTTON_MAPPING[_BUTTONS.WEST_BTN] = hideObject;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_SHOULDER] = decAltitude;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_SHOULDER] = incAltitude;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_TRIGGER] = explode;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_TRIGGER] = fineSpeedAdjust;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_STICK_BUTTON] = deselectAll;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_STICK_BUTTON] = unhideAll;\n                break;\n            default:\n                _BUTTON_MAPPING[_BUTTONS.SOUTH_BTN] = selectObject;\n                _BUTTON_MAPPING[_BUTTONS.EAST_BTN] = createSavePoint;\n                _BUTTON_MAPPING[_BUTTONS.WEST_BTN] = hideObject;\n                _BUTTON_MAPPING[_BUTTONS.NORTH_BTN] = showPropertyPanel;\n                _BUTTON_MAPPING[_BUTTONS.SOUTH_DPAD] = goHome;\n                _BUTTON_MAPPING[_BUTTONS.WEST_DPAD] = previousSavePoint;\n                _BUTTON_MAPPING[_BUTTONS.EAST_DPAD] = nextSavePoint;\n                _BUTTON_MAPPING[_BUTTONS.NORTH_DPAD] = toggleNavMode;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_SHOULDER] = decAltitude;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_SHOULDER] = incAltitude;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_TRIGGER] = triggerZoom;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_TRIGGER] = fineSpeedAdjust;\n                _BUTTON_MAPPING[_BUTTONS.RIGHT_STICK_BUTTON] = deselectAll;\n                _BUTTON_MAPPING[_BUTTONS.LEFT_STICK_BUTTON] = unhideAll;\n                break;\n        }\n    };\n\n    //things buttons can do below\n    var goHome = function(){\n        viewerapi.navigation.setRequestHomeView(true);\n        viewerapi.showAll();\n        viewerapi.impl.selector.clearSelection();\n        viewerapi.explode(0);\n    };\n\n    //Shoulder buttons and triggers\n    var decAltitude = function() {\n        if (_lockInPlane)\n            _altitudeLockCoord += (-_gamepad.buttons[_BUTTONS.LEFT_SHOULDER].pressed) * _actualMoveSpeed;\n        else\n            _camera.translateY(-_gamepad.buttons[_BUTTONS.LEFT_SHOULDER].pressed * _actualMoveSpeed);\n    };\n\n    var incAltitude = function() {\n        if (_lockInPlane)\n            _altitudeLockCoord += (_gamepad.buttons[_BUTTONS.RIGHT_SHOULDER].pressed) * _actualMoveSpeed;\n        else\n            _camera.translateY(_gamepad.buttons[_BUTTONS.RIGHT_SHOULDER].pressed * _actualMoveSpeed);\n    };\n\n    var explode = function(analog_value){\n        if (analog_value > _THRESHOLD) {\n            if (analog_value == 0.5) {//not set yet\n                viewerapi.explode(0);\n                return;\n            }\n            _explodeSpeed = analog_value;\n            var ns = _explodeSpeed;\n            if (ns > 1) ns = 1;\n            if (ns < 0) ns = 0;\n            viewerapi.explode(ns);\n        }\n        else\n            viewerapi.explode(0);\n    };\n\n\n    //Triggers are analog, so pass in value of trigger\n    var triggerZoom = function(analog_value){\n        if (analog_value > _THRESHOLD) {\n            if(analog_value == 0.5) {\n                _camera.fov = _INITIAL_FOV;\n                _btnPressMap[_BUTTONS.LEFT_TRIGGER] = false;\n                return;\n            }\n            //linear interp: y = -40x + 75\n            ///75 is original fov angle. smaller slope = greater max zoom.\n            // equation will interpolate between based on trigger pressure (analog)\n            _camera.fov = _ZOOM_SCALAR * analog_value + _INITIAL_FOV;\n        }\n        else {\n            _camera.fov = _INITIAL_FOV;//originally 75\n        }\n    };\n\n    var fineSpeedAdjust = function(analog_value){\n        if(analog_value > _THRESHOLD){\n            if(analog_value == 0.5) {//ignore\n                //TODO set speed correctly before input received AND have whole speedadjust down here!!\n                _btnPressMap[_BUTTONS.RIGHT_TRIGGER] = false;\n                return;\n            }\n            _speed_scalar = -(_SPEED_ADJUST * analog_value) + _INITIAL_SPEED_SCALAR;\n        }\n        else{\n            _speed_scalar = _INITIAL_SPEED_SCALAR;\n        }\n\n    };\n\n    var createSavePoint = function(){\n        var state = _viewerState.getState(VIEWER_STATE_FILTER);\n        _savepoints.push(state);\n        avp.logger.log(\"Savepoint created.\");\n    };\n\n    var previousSavePoint = function(){\n        if (_savepoints.length) {\n            _nextsavepoint--;\n            if (_nextsavepoint < 0)\n                _nextsavepoint = _savepoints.length - 1;\n            _viewerState.restoreState(_savepoints[_nextsavepoint]);\n        }\n    };\n\n    var nextSavePoint = function(){\n        if (_savepoints.length) {\n            _nextsavepoint++;\n            if (_nextsavepoint >= _savepoints.length)\n                _nextsavepoint = 0;\n            _viewerState.restoreState(_savepoints[_nextsavepoint]);\n        }\n    };\n\n    var selectObject = function(){\n        var res = viewerapi.impl.hitTestViewport(new THREE.Vector3(0, 0, 0));\n        if(_currentTool == \"headtracker\"){\n            //vr tool forgets to do this, necessary for center selection\n            _camera.updateMatrixWorld();\n        }\n        if (res) {\n            viewerapi.impl.selector.toggleSelection(res.dbId, res.model);\n            //viewerapi.fitToView(res.dbId);\n        } else {\n            viewerapi.impl.selector.clearSelection();\n        }\n    };\n\n    var deselectAll = function() {\n        viewerapi.impl.selector.clearSelection();\n    };\n\n    var unhideAll = function() {\n        viewerapi.showAll();\n        viewerapi.impl.selector.clearSelection();\n        viewerapi.explode(0);\n    };\n\n    var hideObject = function(){\n        var res = viewerapi.impl.hitTestViewport(new THREE.Vector3(0, 0, 0), false);\n        if (res) {\n            // TODO: this doesn't seem right. Probably should use indexOf()\n            if (res.dbId in viewerapi.getHiddenNodes())\n                viewerapi.show(res.dbId);\n            else\n                viewerapi.hide(res.dbId);\n        }\n    };\n\n    var showPropertyPanel = function(){\n        viewerapi.getPropertyPanel(true).setVisible(!viewerapi.getPropertyPanel(true).isVisible());\n    };\n\n    var toggleNavMode = function(){\n        _lockInPlane = !_lockInPlane;\n        if(_lockInPlane)\n            _altitudeLockCoord = _camera.position.z;\n        showDPadHud(\"up\");\n    };\n\n    init();\n};\n\n","import { GamepadModule } from '../Gamepad/GamepadModule'\nconst av = Autodesk.Viewing;\n    /*\n     * First Person View tool for LMV\n     *\n     * This tool provides a first person view with movement using the standard WASD keys\n     * to forward/backward/left/right and the QE keys to move vertically.  The mouse or\n     * cursor is used to orient the view.  Movement is always along or perpendicular to\n     * the view direction.\n     *\n     * The SHIFT key may be used when moving to increase the speed.  Or the default\n     * movement speed may be increased/decreased with the MINUS or EQUAL keys.  The\n     * ZERO (0) will reset to the default speed values.\n     *\n     * @author Hans Kellner (Oct 2014)\n     *\n     */\n    export function FirstPersonTool( viewerapi ) {\n\n        var avp = Autodesk.Viewing.Private;\n\n        var _isMac = (navigator.userAgent.search(\"Mac OS\") != -1);\n        var _navapi = viewerapi.navigation;\n        var _container = viewerapi.container;\n        var _camera = _navapi.getCamera();\n        var _names = [\"firstperson\"];\n\n        this.setGlobalManager(viewerapi.globalManager);\n\n        var _modifierState = { SHIFT: 0, ALT: 0, CONTROL: 0 };  // TODO: Use the hotkeymanager for these.\n        var _keys = Autodesk.Viewing.KeyCode;\n\n        var _isActive = false;\n\n        // true to disable mouse & keyboard navigation.  Used when a HUD is visible to simulate\n        // a modal dialog.\n        var _ignoreMouseAndKeyNav = false;\n\n        // if true then mouse drag changes view orientation, otherwise just mouse move.\n        // If this is set to false then auto-tracking is enabled which might be a usability\n        // issue depending on where the cursor is locate when the tool is enabled.\n        // Movement is based on the distance the cursor is located from the center of\n        // the screen.  If the cursor is away from center when the tool is enabled then\n        // in auto-tracking (non-drag) mode the camera will begin moving.  This may be\n        // disconcerting to the user.\n        var _mouseDraggingLookMode = true;\n\n        var _isDragging = false;\n        var _mouseButtons = 0;\n        var _touchType = null;\n\n        var _clock = new THREE.Clock(true);\n\n        var _hudMessageStartShowTime = -1;\n        var _hudMessageShowTime = 5000;     // milliseconds to show HUD\n\n        var _modelUnitScale = 1.0; // meters\n        var _modelScaleFactor = 1.0;\n\n        // These values define how fast/slow the camera movements are made.\n        // Adjust these to fine tune the movement.\n        var _movementSpeedDefault = 2.0;\n        var _movementSpeed = 2.0;\n        var _wheelMovementSpeed = 1.0;\n        var _verticalMovementSpeed = 0.5;\n        var _lookSpeed = 0.0035;\n\n        // Distance from middle of screen (non-drag) or start position (drag) that's\n        // considered a neutral no-move zone when in non-drag movement mode.\n        var _neutralZoneDist = 40;\n\n        var _wheelDelta = 0;\n\n        // Current cursor\n        var _mouseXstart = 0, _mouseDX = 0, _lastX = -1e20;\n        var _mouseYstart = 0, _mouseDY = 0, _lastY = -1e20;\n\n        // Limits on mouse distance to throttle look speed\n        var _mouseXMaxLimit = 400;\n        var _mouseYMaxLimit = 400;\n\n        // Relative movement\n        var _deltaYaw = 0;\n        var _deltaPitch = 0;\n\n        // Key movement flags\n        var _moveForward = false;\n        var _moveBackward = false;\n        var _moveLeft = false;\n        var _moveRight = false;\n        var _moveUp = false;\n        var _moveDown = false;\n\n        // Previous FOV and Perspective settings\n        var _previousFov = _camera.fov;\n        var _restorePreviousFov = false;\n\n        var _wasPerspective = _camera.isPerspective;\n        var _restorePreviousPerspective = false;\n\n        // Help HUD\n        var _bDontShowAgain_HelpHUD = false;\n\n        //gamepad\n        var _gamepadModule;\n        //if this browser supports gamepad, instantiate GamepadModule\n        if(navigator.getGamepads || !!navigator.webkitGetGamepads || !!navigator.webkitGamepads){\n            _gamepadModule = new GamepadModule(viewerapi);\n        }\n\n        //ADP \n        var _trackToolUsed = false;\n\n        // ToolInterface\n\n        this.isActive = function()\n        {\n            return _isActive;\n        };\n\n        this.getNames = function()\n        {\n            return _names;\n        };\n\n        this.getName = function()\n        {\n            return _names[0];\n        };\n\n        this.activate = function(name)\n        {\n            _clock.start();\n\n            // Switch to perspective\n            _wasPerspective = _camera.isPerspective;\n            _navapi.toPerspective();\n\n            // Change FOV to a wide value for a better 1st person experience\n            _previousFov = _camera.fov;\n            _navapi.setVerticalFov(75, true);\n\n            // Unit scale\n            _modelUnitScale = viewerapi.model.getUnitScale();\n\n            // Calculate a movement scale factor based on the model bounds.\n            var boundsSize = viewerapi.model.getBoundingBox().size();\n            _modelScaleFactor = Math.max(Math.min(Math.min(boundsSize.x,boundsSize.y),boundsSize.z) / 10.0, 0.0001);\n\n            // HACK: Place focus in canvas so we get key events.\n            viewerapi.canvas.focus();\n\n            _isActive = true;\n\n            // Display the HUD on startup but only if \"don't show me again\" wasn't requested\n            if (viewerapi.getFirstPersonToolPopup() && !_bDontShowAgain_HelpHUD) {\n                showHelpHUD();\n            }\n\n            this.addCrosshair();\n\n            viewerapi.impl.pauseHighlight(true);\n\n            if (_gamepadModule) {\n                _gamepadModule.activate(this.getName());\n            }\n        };\n\n        this.deactivate = function(name)\n        {\n            _isActive = false;\n\n            _clock.stop();\n\n            hideHUD();\n            this.removeCrosshair();\n\n            if (_restorePreviousFov) {\n                _navapi.setVerticalFov(_previousFov, true);\n            }\n\n            if (_restorePreviousPerspective) {\n                if (!_wasPerspective)\n                    _navapi.toOrthographic();\n            }\n\n            viewerapi.impl.pauseHighlight(false);\n\n            if(_gamepadModule)\n                _gamepadModule.deactivate();\n\n        };\n\n        this.getCursor = function()\n        {\n            return \"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3goOFQoQszohGAAAA9hJREFUSMedll1oHGUUhp8zuzP5291pEvNTomgVjFCCCa0NpAqJEJTUFVv8uWxQLwKCF6IUr7wJ6J30QvBCAlZssA0EkYJaAm1FwU3iakrbVNNuutlukk3dzWyT/ZnJ7ufFTtokbmvX72Y45+N73/Oe8858I+xYSikBJJFI7AmFQh9alvVWoVC47vP5ho4cOXJeRGwqWN4yOQ2oHh0dPROJRNo7OjqIRCKPRxeiP66srBxSSn0vIsX/RaCU0gDV399vNjQ0tB8/fpxAIEAsFuP06dPEYrFvgHqguEMxIqLKdUPbmnArU52dnb2maWJUGeRyOWzbpqGxgXg87gOMncDlwLe2Y5uCwcHBFp/P90k4PE349xkWolGi0SjhPy5hF+UmIEopz/1AtxRcqmJzDQ8P7750+Wq8e9+TPGLe4sSp39jz9LMsxm/izE6gOVnquoIcOHDgnddfe/VEU3PLWkUzSCQSesCzxNtvHKZu11O0137OuTMneYY1+l+px99sci5zgU+/Pv/Z5OTkWeCvigja2tqqri3/RPbiMfSWLvY+/wJ7XwxCOoyz+gPF5C0OzsFZv8NEOOxU7KL5+fkcooFUo9avYt+4htTU43noJVTmIPYvp8hnChSKCr/fr1VMkEqlCgEATUDTAIVykhSWRtj4M4/KKzZ9Z9u2ehCCbVUYhlEaurg7m09NB/GWYhe2r69vV8UEvb29DeIWL+6uIG6w6b1SGAqF0hUTZDKZ7GLKy1w0h+Z1keQuMEDOKbK+oZFIJOyKZqCUEsuy/k4mk6kr0ZH6/Z2CkrttEl1QjuJkKI3z6KGp6vTFpYoVmKaZ9Xg8lleDoq3IzOdBILuygbVgs2YVSNrgOM7o1NTURkUE7qufX15evo5A0VHcnrNRgFgFJF6gsVmntlaIxWKNIlK/s8D/VCAianZ29spmv0vfVoVuaNT6PYhWMpGIGIZhNAGtQC3bbXDfj51YlrWObHeOKu3didfX1x3btgGqgADgu5eafyXT6XT2zmDLnVDg9Xq9uq573fMeQAeqy+HtTAgguq7h0aUsgyZCJpPZcBxnE1xz3fhACqp7enoe+3ZimVg8j6ELiIACEUETWErnsCwrD2h1dXW6C+4A2a033T0VfPD+e8dePvoFb36sM/LzKomkQ1FgMW3z7neL3Gh6jtbW1rmamhrDNM0NYAVIAYWyl06ZPwoNeHh6evqJmZmZiV8vnCBw+yLRRCv7gkdpamr6aGho6KuBgQFnfHx88V7AZQlcEt01jgD+sbGx3V+OjPR07d8fDQaDl1OpVLK7u9swTXP1Qa7NfwCi46BIaoRmhAAAAABJRU5ErkJggg==), auto\";\n        };\n\n        this.adjustSpeed = function( direction )\n        {\n            if ( direction === 0 ) { // reset to default\n                _movementSpeed = _movementSpeedDefault;\n            }\n            else {\n                _movementSpeed *= (direction > 0) ?  1.10 : 0.90;\n                if ( _movementSpeed < 0.01 ) {\n                    _movementSpeed = 0.01;\n                }\n            }\n        };\n\n        function getEventModifierState(event)\n        {\n            if ( !!_touchType )\n                return false;\n\n            var ctrlKey = event.ctrlKey || (_isMac && event.metaKey);\n            var metaKey = event.metaKey && !_isMac;\n\n            //console.log(\"Mod keys: ctrl = \"+ctrlKey+\" meta = \"+metaKey+\" alt^ctrl = \"+ (event.altKey ^ ctrlKey));\n\n            return ctrlKey || metaKey || event.shiftKey || event.altKey;\n        }\n\n        /////////////////////////////////////////////////////////////////////////\n        // Tool event handler callbacks - can use \"this\".\n\n        this.handleGesture = function( event )\n        {\n            // Convert Hammer touch-event X,Y into mouse-event X,Y.\n            if (event.pointers && event.pointers.length > 0) {\n                event.pageX = event.pointers[0].pageX;\n                event.pageY = event.pointers[0].pageY;\n            }\n\n            switch( event.type )\n            {\n                case \"dragstart\":\n                    _touchType = \"drag\";\n                    // Single touch, fake the mouse for now...\n                    return this.handleButtonDown(event, 0);\n\n                case \"dragmove\":\n                    return (_touchType === \"drag\") ? this.handleMouseMove(event) : false;\n\n                case \"dragend\":\n                    if( _touchType === \"drag\" )\n                    {\n                        this.handleButtonUp(event, 0);\n                        _touchType = null;\n                        return true;\n                    }\n                    return false;\n            }\n\n            return false;\n        };\n\n        this.handleSingleClick = function( event, button )\n        {\n            return false;\n        };\n\n        this.handleButtonDown = function( event, button )\n        {\n            const _window = this.getWindow();\n            hideHUD();\n\n            _mouseButtons += 1 << button;\n\n            var modifierState = getEventModifierState(event);\n            if (button === 0 && !modifierState) {\n\n                _mouseXstart = event.pageX - _window.innerWidth / 2;\n                _mouseYstart = event.pageY - _window.innerHeight / 2;\n\n                _lastX = event.pageX;\n                _lastY = event.pageY;\n\n                _deltaYaw = _deltaPitch = 0;\n                _mouseDX = _mouseDY = 0;\n                _isDragging = true;\n                return true;\n            }\n\n            return true;    // Eat all these so default tools don't screw with view\n        };\n\n        this.handleMouseMove = function( event )\n        {\n            var dx = (_lastX < -1e10) ? 0 : event.pageX - _lastX;\n            var dy = (_lastY < -1e10) ? 0 : event.pageY - _lastY;\n            _lastX = event.pageX;\n            _lastY = event.pageY;\n\n            if ( (_isDragging === _mouseDraggingLookMode) && !_ignoreMouseAndKeyNav)\n            {\n                // Joystick Camera Orientation\n                /** DISABLED\n                 var xNew = event.pageX - window.innerWidth / 2;\n                 var yNew = event.pageY - window.innerHeight / 2;\n                 if (_mouseDraggingLookMode) {\n                // If in drag mode then movement is relative to start point\n                _mouseDX = xNew - _mouseXstart;\n                _mouseDY = yNew - _mouseYstart;\n            }\n                 else {\n                _mouseDX = xNew;\n                _mouseDY = yNew;\n            }\n                 // A circular area in the middle of the screen or around the start point\n                 // defines a neutral area in which no movement occurs.\n                 var mouseMoveDist = Math.sqrt( _mouseDX * _mouseDX + _mouseDY * _mouseDY );\n                 if ( mouseMoveDist < _neutralZoneDist ) {\n                _mouseDX = _mouseDY = 0;\n            }\n                 DISABLED **/\n\n                    // Discrete Camera Orientation\n                _deltaYaw   += dx * _lookSpeed;\n                _deltaPitch += dy * _lookSpeed;\n            }\n\n            return true;    // Eat all these so default tools don't screw with view\n        };\n\n        this.handleButtonUp = function( event, button )\n        {\n            _mouseButtons -= 1 << button;\n\n            // If are dragging for a specific button then end dragging no matter\n            // what the state of the modifiers.  Otherwise you won't end dragging.\n            if (button === 0 && _isDragging) {\n                _deltaYaw = _deltaPitch = 0;\n                _mouseDX = _mouseDY = 0;\n                _isDragging = false;\n                return true;\n            }\n\n            return true;    // Eat all these so default tools don't screw with view\n        };\n\n        this.handleKeyDown = function( event, keyCode )\n        {\n            if (_ignoreMouseAndKeyNav) {\n                return false;\n            }\n\n            hideHUD();\n\n            var isModKey = false;\n            var handled = false;\n\n            switch( keyCode )\n            {\n                case _keys.ESCAPE:\n                    break;\n\n                case _keys.TAB: handled = false; break;\n\n                // Eat the modifiers so defualt tools don't activate and mess with cam\n                case _keys.SHIFT:   _modifierState.SHIFT = 1;   isModKey = handled = true; break;\n                case _keys.CONTROL: _modifierState.CONTROL = 1; isModKey = handled = true; break;\n                case _keys.ALT:     _modifierState.ALT = 1;     isModKey = handled = true; break;\n                case _keys.SPACE:   _modifierState.SPACE = 1;   isModKey = handled = true; break;\n\n                case _keys.EQUALS: this.adjustSpeed(1);  handled = true; break;\n                case _keys.DASH:   this.adjustSpeed(-1); handled = true; break;\n                case _keys.ZERO:   this.adjustSpeed(0);  handled = true; break; // Reset dolly speed to default\n\n                case _keys.UP:\n                case _keys.w:\n                    _moveForward = true; handled = true;\n                    break;\n\n                case _keys.LEFT:\n                case _keys.a:\n                    _moveLeft = true; handled = true;\n                    break;\n\n                case _keys.DOWN:\n                case _keys.s:\n                    _moveBackward = true; handled = true;\n                    break;\n\n                case _keys.RIGHT:\n                case _keys.d:\n                    _moveRight = true; handled = true;\n                    break;\n\n                case _keys.q:\n                    _moveUp = true; handled = true;\n                    break;\n\n                case _keys.e:\n                    _moveDown = true; handled = true;\n                    break;\n\n                case _keys.g:\n                    handled = true;\n                    break;\n\n                case _keys.F1:\n                    handled = true;\n                    break;\n            }\n\n            return handled;\n        };\n\n        this.handleKeyUp = function( event, keyCode )\n        {\n            if (_ignoreMouseAndKeyNav) {\n                return false;\n            }\n\n            var isModKey = false;\n            var handled = false;\n\n            switch( keyCode )\n            {\n                case _keys.TAB:\n                    handled = false;\n                    break;\n\n                // Eat the modifiers so defualt tools don't activate and mess with cam\n                case _keys.SHIFT:   _modifierState.SHIFT = 0;   isModKey = handled = true; break;\n                case _keys.CONTROL: _modifierState.CONTROL = 0; isModKey = handled = true; break;\n                case _keys.ALT:     _modifierState.ALT = 0;     isModKey = handled = true; break;\n                case _keys.SPACE:   _modifierState.SPACE = 0;   isModKey = handled = true; break;\n\n                case _keys.UP:\n                case _keys.w:\n                    _moveForward = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.LEFT:\n                case _keys.a:\n                    _moveLeft = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.DOWN:\n                case _keys.s:\n                    _moveBackward = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.RIGHT:\n                case _keys.d:\n                    _moveRight = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.q:\n                    _moveUp = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.e:\n                    _moveDown = false; handled = true;\n                    firstPersonToolUsed();\n                    break;\n\n                case _keys.g:\n                    _mouseDX = _mouseDY = 0;\n                    _mouseDraggingLookMode = !_mouseDraggingLookMode;\n                    showDraggingLookModeHUD(_mouseDraggingLookMode);\n                    handled = true;\n                    break;\n\n                case _keys.F1:\n                    showHelpHUD();\n                    handled = true;\n                    break;\n            }\n\n            return handled;\n        };\n\n        this.handleWheelInput = function(delta)\n        {\n            if (_ignoreMouseAndKeyNav) {\n                return false;\n            }\n\n            if ( _navapi.getReverseZoomDirection() )\n                delta *= -1;\n\n            _wheelDelta += delta;\n\n            return true;\n        };\n\n        this.handleSingleClick = function( event, button ) {\n            return false;\n        };\n\n        this.handleDoubleClick = function( event, button ) {\n            return false;\n        };\n\n        this.handleSingleTap = function( event )\n        {\n            return this.handleSingleClick(event, 0);\n        };\n\n        this.handleDoubleTap = function( event ) {\n            return false;\n        };\n\n        this.handleBlur = function(event)\n        {\n            // Reset things when we lose focus...\n            _moveForward = _moveBackward = false;\n            _moveLeft = _moveRight = false;\n            _moveUp = _moveDown = false;\n\n            return false;\n        };\n\n        this.update = function()\n        {\n\n            if (!_isActive || !_navapi.isActionEnabled('walk'))\n                return false;\n\n            var delta = _clock.getDelta();//returns delta in unit seconds\n\n            if (_hudMessageStartShowTime > -1) {\n                var curTime = new Date().getTime();\n                if (curTime - _hudMessageStartShowTime > _hudMessageShowTime) { // seconds\n                    hideHUD();\n                }\n            }\n\n            // From the Collaboration extension:\n            //the \"go home\" call may change the camera back to ortho... and we can't do ortho while walking...\n            //HACK: Really, the home view should be set once when launch the extension, then set it back.\n            if (!_camera.isPerspective) {\n                console.log(\"Lost perspective mode: resetting view.\");\n                _navapi.toPerspective();\n            }\n\n            var localCam = _camera.clone();   // Copy of camera to modify\n\n            // Handle movement changes\n\n            var actualMoveSpeed         = delta * _movementSpeed         * _modelScaleFactor * (_modifierState.SHIFT === 1 ? 4 : 1);\n            var actualVerticalMoveSpeed = delta * _verticalMovementSpeed * _modelScaleFactor * (_modifierState.SHIFT === 1 ? 4 : 1);\n\n\n            if (_wheelDelta != 0) {\n                var actualWheelMoveSpeed = _wheelDelta * _wheelMovementSpeed * _modelScaleFactor * (_modifierState.SHIFT === 1 ? 4 : 1);\n                localCam.translateZ( -actualWheelMoveSpeed );\n                _wheelDelta = 0;\n            }\n\n            if ( _moveForward ) {\n                localCam.translateZ(-actualMoveSpeed);\n            }\n\n            if ( _moveBackward ) {\n                localCam.translateZ( actualMoveSpeed );\n            }\n\n            if ( _moveLeft ) {\n                localCam.translateX( -actualMoveSpeed );\n            }\n\n            if ( _moveRight ) {\n                localCam.translateX( actualMoveSpeed );\n            }\n\n            if ( _moveUp ) {\n                localCam.translateY( actualVerticalMoveSpeed );\n            }\n\n            if ( _moveDown ) {\n                localCam.translateY( -actualVerticalMoveSpeed );\n            }\n\n            var newPosition = localCam.position;\n            var posChanged = (newPosition.distanceToSquared(_camera.position) !== 0);\n\n            // Handle look changes\n\n            // var actualLookSpeed = delta * _lookSpeed;\t\n\n            var newTarget = localCam.target;\n\n            var directionFwd = _camera.target.clone().sub(_camera.position);\n            //directionFwd = directionFwd.sub((directionFwd.multiply(_camera.worldup)).multiply(_camera.worldup));\n\n            var directionRight = directionFwd.clone().cross(_camera.up).normalize();\n\n            /** Joystick Camera Orientation\n             ** This code enabled continuous movement of camera as apposed to the\n             ** discrete movement mode below.  Moving the cursor outside of the\n             ** center of the view orients the camera in that direction and continues\n             ** moving while cursor is outside neutral center.  It works like a\n             ** virtual joystick.\n             **\n             ** Uncomment/Comment these sections to switch the style of camera orientation.\n             **/\n\n            /** DISABLED\n             var dyawAngle = 0, dpitchAngle = 0;\n             if (Math.abs(_mouseDX) > _neutralZoneDist) {\n            if (_mouseDX > 0) {\n                _mouseDX = Math.min(_mouseDX, _mouseXMaxLimit); // Throttle look speed.\n                dyawAngle = (_mouseDX - _neutralZoneDist) * actualLookSpeed;\n            }\n            else {\n                _mouseDX = Math.max(_mouseDX, -_mouseXMaxLimit); // Throttle look speed.\n                dyawAngle = (_mouseDX + _neutralZoneDist) * actualLookSpeed;\n            }\n        }\n             if (Math.abs(_mouseDY) > _neutralZoneDist) {\n            if (_mouseDY > 0) {\n                _mouseDY = Math.min(_mouseDY, _mouseYMaxLimit); // Throttle look speed.\n                dpitchAngle = (_mouseDY - _neutralZoneDist) * actualLookSpeed;\n            }\n            else {\n                _mouseDY = Math.max(_mouseDY, -_mouseYMaxLimit); // Throttle look speed.\n                dpitchAngle = (_mouseDY + _neutralZoneDist) * actualLookSpeed;\n            }\n        }\n             if (dpitchAngle) {\n            var pitchQ = new THREE.Quaternion();\n            pitchQ.setFromAxisAngle(directionRight, -dpitchAngle);\n            // Need to limit pitch to +-85 degrees so we don't create\n            // camera jumping at vertical limits.\n            var dirFwdTmp = directionFwd.clone();\n            dirFwdTmp.applyQuaternion(pitchQ);\n            var vertical = _camera.worldup.clone();\n            var vertAngle = dirFwdTmp.angleTo(vertical);\n            var vertLimit = THREE.Math.degToRad(5);\n            // If new angle is within limits then update values; otherwise ignore\n            if ( vertAngle >= vertLimit && vertAngle <= (Math.PI - vertLimit) ) {\n                directionFwd.applyQuaternion(pitchQ);\n                localCam.up.applyQuaternion(pitchQ);\n            }\n        }\n             if (dyawAngle) {\n            var yawQ = new THREE.Quaternion();\n            yawQ.setFromAxisAngle(_camera.worldup, -dyawAngle);\n            directionFwd.applyQuaternion(yawQ);\n            localCam.up.applyQuaternion(yawQ);\n        }\n             DISABLED **/\n\n            /** Discrete Camera Orientation\n             ** Movement based on the delta changes in position or cursor.  See the\n             ** the \"Dynamic Move\" code for an alternative.  In this mode the camera\n             ** is oriented based on the delta movement of the cursor.  Movement\n             ** stops as camera is oriented to new change of cursor.\n             ** TODO: Add logic to smooth motion so camera position ramps towards\n             ** the new location rather than discrete jumps.\n             **/\n\n            if (_deltaPitch != 0) {\n                var pitchQ = new THREE.Quaternion();\n                pitchQ.setFromAxisAngle(directionRight, -_deltaPitch);\n                // Need to limit pitch to +-85 degrees so we don't create\n                // camera jumping at vertical limits.\n                var dirFwdTmp = directionFwd.clone();\n                dirFwdTmp.applyQuaternion(pitchQ);\n\n                var vertical = _camera.worldup.clone();\n                var vertAngle = dirFwdTmp.angleTo(vertical);\n                var vertLimit = THREE.Math.degToRad(5);\n\n                // If new angle is within limits then update values; otherwise ignore\n                if ( vertAngle >= vertLimit && vertAngle <= (Math.PI - vertLimit) ) {\n                    directionFwd.applyQuaternion(pitchQ);\n                    localCam.up.applyQuaternion(pitchQ);\n                }\n\n                _deltaPitch = 0.0;\n            }\n\n            if (_deltaYaw != 0) {\n                var yawQ = new THREE.Quaternion();\n                yawQ.setFromAxisAngle(_camera.worldup, -_deltaYaw);\n                directionFwd.applyQuaternion(yawQ);\n                localCam.up.applyQuaternion(yawQ);\n                _deltaYaw = 0.0;\n            }\n\n            // Now calc new target location and if it changed.\n            newTarget = newPosition.clone().add(directionFwd);\n            //now fix newPosition for lockInPlane\n            var targetChanged = (newTarget.distanceToSquared(_camera.target) !== 0);\n            // If position or target changed then update camera.\n            if (posChanged || targetChanged) {\n\n                _navapi.setView(newPosition, newTarget);\n                //_camera.position = newPosition.clone();\n                //_camera.target = newTarget.clone();\n                //_camera.dirty = true;s\n                // Force the camera to stay orientated up with world up.\n                _navapi.orientCameraUp();\n            }\n\n            //gamepad integration\n            if(_gamepadModule){\n                _camera =  _gamepadModule.update(_camera);\n            }\n\n            return _camera.dirty;\n\n\n        };\n        //ADP\n        var firstPersonToolUsed = function () {\n            if(!_trackToolUsed) {\n                avp.logger.track({category: 'tool_used', name: 'FirstPerson_tool'});\n                _trackToolUsed = true;\n            }\n        }\n\n\n        /////////////////////////////////////////////////////////////////////////\n        // HUD helpers\n\n        // Show a HUD for a specific amount of time (showDelay > 0) or until closed.\n        var showHUD = function(messageSpecs, showDelay, closeCB, buttonCB, checkboxCB)\n        {\n            // TODO: Tool should not be trying to interact with UI\n            // Does not comply with headless viewer policy.\n            if (!Autodesk.Viewing.Private.HudMessage) {\n                return;\n            }\n\n            Autodesk.Viewing.Private.HudMessage.displayMessage(_container, messageSpecs, closeCB, buttonCB, checkboxCB);\n\n            if (showDelay > 0) {\n                _hudMessageStartShowTime = new Date().getTime();\n                _hudMessageShowTime = showDelay;\n            }\n            else {\n                _hudMessageStartShowTime = -1;\n                _hudMessageShowTime = 0;\n            }\n        };\n\n        var hideHUD = function()\n        {\n            // TODO: Tool should not be trying to interact with UI\n            // Does not comply with headless viewer policy.\n            if (Autodesk.Viewing.Private.HudMessage) {\n                Autodesk.Viewing.Private.HudMessage.dismiss();  // in case it's still visible\n            }\n            _hudMessageStartShowTime = -1;\n        };\n\n        var showDraggingLookModeHUD = function(enabled)\n        {\n            hideHUD();\n\n            var themessage = (enabled \n                    ? \"Press the primary mouse button and drag to change the view orientation\"\n                    : \"Move the cursor to change the view orientation\");\n\n            var messageSpecs = {\n                \"msgTitleKey\"   : \"First Person Tool\",\n                \"messageKey\"    : themessage,\n                \"messageDefaultValue\"  : themessage\n            };\n\n            var closeCallback = function() {}; // dummy callback function so that the 'X' is shown\n            showHUD(messageSpecs, 0, closeCallback);\n        };\n\n\n        var showHelpHUD = function()\n        {\n            hideHUD();\n\n            // TODO: Sadly, the HudMessage api doesn't support html formatted messages\n            var messageSpecs = {\n                \"msgTitleKey\"           : \"First Person Tool\",\n                \"messageKey\"            : \"Use the WASD and QE keys to move\",\n                \"messageDefaultValue\"   : \"Use the WASD and QE keys to move\", // simplify key and remove peroid\n                \"buttonText\"            : \"Ok Got It\"\n            };\n\n            var closeCallback = function() {}; // dummy callback function so that the 'X' is shown\n            var buttonCallback = function() {\n                _bDontShowAgain_HelpHUD = true;\n                viewerapi.setFirstPersonToolPopup(false);\n                hideHUD();\n            };\n            showHUD(messageSpecs, 0, closeCallback, buttonCallback);\n        };\n\n        this.addCrosshair = function() {\n            if (avp.stringToDOM) {\n                this.crosshair = avp.stringToDOM('<div id=\"remote-crosshair\"><div class=\"crosshair-v\"></div><div class=\"crosshair-h\"></div></div>f');\n                viewerapi.canvasWrap.appendChild(this.crosshair);\n            }\n        };\n\n        this.removeCrosshair = function() {\n            if (this.crosshair && this.crosshair.parentNode) {\n                this.crosshair.parentNode.removeChild(this.crosshair);\n            }\n        };\n    };\n\n    av.GlobalManagerMixin.call(FirstPersonTool.prototype);","import { FirstPersonTool } from './FirstPersonTool'\n\n//\n// First Person\n//\n\n'use strict';\n\n/**\n * First Person navigation tool, similar to those found in videogames.\n *\n * It will also replace the default walk tool button when {@link Autodesk.Viewing.GuiViewer3D} is present.\n * @constructor\n * @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n * @param {Autodesk.Viewing.Viewer3D} viewer - Viewer instance.\n * @param {object} options - Not used.\n */\nexport function FirstPersonExtension(viewer, options) {\n    Autodesk.Viewing.Extension.call(this, viewer, options);\n    this.name = \"firstperson\";\n};\n\nFirstPersonExtension.prototype = Object.create(Autodesk.Viewing.Extension.prototype);\nFirstPersonExtension.prototype.constructor = FirstPersonExtension;\n\nvar proto = FirstPersonExtension.prototype;\n\nproto.load = function() {\n    var self = this;\n    var viewer = this.viewer;\n    var avu = Autodesk.Viewing.UI;\n\n    // Register tool\n    this.tool = new FirstPersonTool(viewer);\n    viewer.toolController.registerTool(this.tool);\n\n    // Add the ui to the viewer.\n    this.createUI();\n    // Register listeners\n    this.onToolChanged = function (e) {\n        if (e.toolName.indexOf('firstperson') === -1) {\n            return;\n        }\n        if (self.firstPersonToolButton) {\n            var state = e.active ? avu.Button.State.ACTIVE : avu.Button.State.INACTIVE;\n            self.firstPersonToolButton.setState(state);\n        }\n    };\n\n    viewer.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT, this.onToolChanged);\n\n    return true;\n};\n\nproto.createUI = function()\n{\n    var viewer = this.viewer;\n    if (!viewer.getToolbar) return; // Adds support for Viewer3D instance\n\n    var self   = this;\n    var avu = Autodesk.Viewing.UI;\n    var toolbar = viewer.getToolbar();\n    var navTools = toolbar.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);\n\n    // Create a button for the tool.\n    this.firstPersonToolButton = new avu.Button('toolbar-firstPersonTool');\n    this.firstPersonToolButton.setToolTip('First person');\n    this.firstPersonToolButton.onClick = function(e) {\n        if(self.activeStatus) {\n            self.deactivate();\n        }\n        else {\n            self.activate();\n        }\n    };\n    this.firstPersonToolButton.setIcon(\"adsk-icon-first-person\");\n\n    var cameraSubmenuTool = navTools.getControl('toolbar-cameraSubmenuTool');\n    if (cameraSubmenuTool) {\n        navTools.addControl(this.firstPersonToolButton, {index: navTools.indexOf(cameraSubmenuTool.getId())});\n    } else {\n        navTools.addControl(this.firstPersonToolButton);\n    }\n};\n\nproto.unload = function() {\n    var viewer = this.viewer;\n\n    // Remove listeners\n    viewer.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT, this.onToolChanged);\n    this.onToolChanged = undefined;\n\n    // Remove hotkey\n    viewer.getHotkeyManager().popHotkeys(this.HOTKEYS_ID);\n\n    // Remove the UI\n    if (this.firstPersonToolButton) {\n        var toolbar = viewer.getToolbar();\n        if (toolbar) {\n            this.firstPersonToolButton.removeFromParent();\n        }\n        this.firstPersonToolButton = null;\n    }\n\n    //Uh, why does the viewer need to keep track of this in addition to the tool stack?\n    if (viewer.getActiveNavigationTool() == this.tool.getName())\n        viewer.setActiveNavigationTool();\n\n    // Deregister tool\n    viewer.toolController.deregisterTool(this.tool);\n    this.tool = null;\n\n    return true;\n};\n\nproto.activate = function () {\n    if(!this.activeStatus) {\n        this.viewer.setActiveNavigationTool(\"firstperson\");\n        this.activeStatus = true;\n    }\n    return true;\n};\nproto.deactivate= function() {\n    if(this.activeStatus) {\n        this.viewer.setActiveNavigationTool();\n        this.activeStatus = false;\n    }\n    return true;\n};\n\nAutodesk.Viewing.theExtensionManager.registerExtension('Autodesk.FirstPerson', FirstPersonExtension);\n\n\n"],"sourceRoot":""}